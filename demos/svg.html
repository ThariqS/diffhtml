<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>SVG Demo</title>

  <style>
    html, body { width: 100%; height: 100%; position: relative; padding: 0; margin: 0; }
    svg { 
      position: absolute; top: 0; left: 0; bottom: 0; right: 0; width: 100%; height: 100%; 
      transform: translatez(0);
      transition: all ease-in .3s;
    }
    body { transition: background ease-in .3s; }
  </style>
</head>

<body>
  <svg></svg>
</body>

<script type="template">
  <body style="background: rgba({{ r }}, {{ g }}, {{ b }}, {{ o }})">
    <svg width="100%" height="100%">
      {%each rects as rect%}
        <rect
          rx="{{ rect.rx }}"
          ry="{{ rect.ry }}"
          x="{{ rect.x }}"
          y="{{ rect.y }}"
          height="{{ rect.height }}"
          width="{{ rect.width }}"
          style="transition: all {{ rect.tween }} .3s;fill:rgba({{ rect.r }}, {{ rect.g }}, {{ rect.b }}, {{ rect.o }})"
        />
      {%endeach%}
    </svg>
  </body>
</script>

<script src="dist/diffhtml.js"></script>
<script src="benchmarks/node_modules/combyne/dist/combyne.js"></script>

<script>
  var template = combyne(document.querySelector('[type=template]').innerHTML);
  var body = document.querySelector('body');
  var count = 0;
  var rects = new Array(count);

  function render() {
    var tweens = [
      'linear'
    ];

    // Cap for now.
    if (count < 1000) {
      ++count;
    }

    for (var i = 0; i < count; i++) {
      var random = Math.random();
      var r = Math.floor(Math.random() * 255);
      var g = Math.floor(Math.random() * 255);
      var b = Math.floor(Math.random() * 255);
      var height = Math.floor(random * 20);
      var width = Math.floor(random * 20);
      var tween = Math.floor(random * tweens.length);

      var oldRect = rects[i] || {};
      var rect = rects[i] = {
        rx: 1000,
        ry: 1000,
        rotate: Math.floor(Math.random() * 360),
        tween: tweens[tween],
        o: Math.floor(100-(Math.random() * 100)),
        r: r,
        g: g,
        b: b,
        x: Math.floor(Math.random() * Math.abs(window.innerWidth - width)),
        y: Math.floor(Math.random() * Math.abs(window.innerHeight - height)),
        width: width,
        height: height 
      };
    }

    body.outerDiffHTML = template.render({
      o: Math.floor(100-(Math.random() * 100)),
      r: Math.floor(Math.random() * 255),
      g: Math.floor(Math.random() * 255),
      b: Math.floor(Math.random() * 255),
      rects: rects
    });

    setTimeout(function() {
      requestAnimationFrame(render);
    }, 300);
  }

  render();
</script>
</html>
